{% comment %}
  Product Tile Snippet - Converted from ProductTile.jsx
  Usage: {% render 'product-tile', product: product %}
{% endcomment %}

<li class="o-listing-grid__item">
  <div class="m-tile-slider" data-behavior="mTileSlider">
    <div class="m-tile-slider__visual">
      {% comment %} Quick Add Button {% endcomment %}
      <button 
        type="button" 
        class="m-tile-slider__quick-add" 
        data-quick-add
        data-product-id="{{ product.id }}"
        data-product-handle="{{ product.handle }}"
        aria-label="Quick add {{ product.title }} to cart"
      >
        <span class="m-tile-slider__quick-add-icon">+</span>
      </button>
      
      <div class="m-tile-slider__controls">
        {% if product.images.size > 1 %}
          <div 
            class="m-tile-slider__indicator" 
            style="--i-width: {{ 100 | divided_by: product.images.size }}%"
            data-tile-indicator
          >
            <span style="left: 0%" data-tile-indicator-bar></span>
          </div>
        {% endif %}
      </div>

      <div class="m-tile-slider__wrapper" role="group" data-tile-slider>
        {% for image in product.images %}
          <a
            class="m-tile-slider__slide {% if forloop.first %}m-tile-slider__slide--active{% endif %}"
            data-i="{{ forloop.index }}"
            aria-roledescription="slide"
            aria-label="{{ forloop.index }} OF {{ product.images.size }}"
            href="{{ product.url }}"
            data-tile-slide
          >
            <img
              src="{{ image | image_url: width: 2048, height: 2048, crop: 'center' }}"
              alt="{{ image.alt | default: product.title }}"
              loading="{% if forloop.first %}eager{% else %}lazy{% endif %}"
              sizes="(min-width: 1680px) 15vw, (min-width: 1024px) 20vw, (min-width: 768px) 33.33vw, 50vw"
            >
          </a>
        {% endfor %}
      </div>
    </div>

    <a href="{{ product.url }}" class="m-product-listing__meta">
      <h2 class="m-product-listing__meta-title f-body">
        {{ product.title }}
        {% if product.variants.first.option1 != blank %}
          <span class="a11y">; {{ product.variants.first.option1 }}</span>
        {% endif %}
      </h2>

      {% if product.price %}
        <p class="m-product-listing__meta-price f-body--em">
          <span class="prices">
            <strong data-description="value" class="f-body--em">
              {{ product.price | money }} {{ cart.currency.iso_code }}
            </strong>
          </span>
        </p>
      {% endif %}
      
      {% comment %} Color Variants {% endcomment %}
      {% assign color_option = product.options_with_values | where: 'name', 'Color' | first %}
      {% if color_option != blank and color_option.values.size > 1 %}
        <div class="m-product-listing__color-variants">
          {% for value in color_option.values limit: 6 %}
            <a 
              href="{{ product.url }}?variant={{ product.variants[forloop.index0].id }}"
              class="m-product-listing__color-variant"
              style="background: linear-gradient(135deg, {{ value | handleize }} 50%, {{ value | handleize }} 50%);"
              aria-label="Color: {{ value }}"
              title="{{ value }}"
            ></a>
          {% endfor %}
        </div>
      {% endif %}
    </a>
  </div>
</li>
